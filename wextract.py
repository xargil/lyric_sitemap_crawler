import base64
import glob
import gzip

from lxml import html

t = '''&#73;&#110;&#32;&#109;&#121;&#32;&#101;&#121;&#101;&#115;&#44;&#32;&#73;&#39;&#109;&#32;&#110;&#111;&#116;&#32;&#108;&#97;&#122;&#121;<br />&#73;&#110;&#32;&#109;&#121;&#32;&#102;&#97;&#99;&#101;&#44;&#32;&#105;&#116;&#39;&#115;&#32;&#110;&#111;&#116;&#32;&#111;&#118;&#101;&#114;<br />&#73;&#110;&#32;&#121;&#111;&#117;&#114;&#32;&#114;&#111;&#111;&#109;&#44;&#32;&#73;&#39;&#109;&#32;&#110;&#111;&#116;&#32;&#111;&#108;&#100;&#101;&#114;<br />&#73;&#110;&#32;&#121;&#111;&#117;&#114;&#32;&#101;&#121;&#101;&#115;&#44;&#32;&#73;&#39;&#109;&#32;&#110;&#111;&#116;&#32;&#119;&#111;&#114;&#116;&#104;&#32;&#105;&#116;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br /><br />&#72;&#101;&#97;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;&#44;&#32;&#107;&#105;&#108;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;<br />&#72;&#101;&#97;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;&#44;&#32;&#107;&#105;&#108;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;<br />&#72;&#101;&#97;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;&#44;&#32;&#107;&#105;&#108;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;<br /><br />&#73;&#110;&#32;&#109;&#121;&#32;&#101;&#121;&#101;&#115;&#44;&#32;&#73;&#39;&#109;&#32;&#110;&#111;&#116;&#32;&#108;&#97;&#122;&#121;<br />&#73;&#110;&#32;&#109;&#121;&#32;&#102;&#97;&#99;&#101;&#44;&#32;&#105;&#116;&#39;&#115;&#32;&#110;&#111;&#116;&#32;&#111;&#118;&#101;&#114;<br />&#73;&#110;&#32;&#121;&#111;&#117;&#114;&#32;&#114;&#111;&#111;&#109;&#44;&#32;&#73;&#39;&#109;&#32;&#110;&#111;&#116;&#32;&#111;&#108;&#100;&#101;&#114;<br />&#73;&#110;&#32;&#121;&#111;&#117;&#114;&#32;&#101;&#121;&#101;&#115;&#44;&#32;&#73;&#39;&#109;&#32;&#110;&#111;&#116;&#32;&#119;&#111;&#114;&#116;&#104;&#32;&#105;&#116;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br /><br />&#72;&#101;&#97;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;&#44;&#32;&#107;&#105;&#108;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;<br />&#72;&#101;&#97;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;&#44;&#32;&#107;&#105;&#108;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;<br />&#72;&#101;&#97;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;&#44;&#32;&#107;&#105;&#108;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;<br /><br />&#73;&#110;&#32;&#109;&#121;&#32;&#101;&#121;&#101;&#115;&#44;&#32;&#73;&#39;&#109;&#32;&#110;&#111;&#116;&#32;&#108;&#97;&#122;&#121;<br />&#73;&#110;&#32;&#109;&#121;&#32;&#102;&#97;&#99;&#101;&#44;&#32;&#105;&#116;&#39;&#115;&#32;&#110;&#111;&#116;&#32;&#111;&#118;&#101;&#114;<br />&#73;&#110;&#32;&#121;&#111;&#117;&#114;&#32;&#114;&#111;&#111;&#109;&#44;&#32;&#73;&#39;&#109;&#32;&#110;&#111;&#116;&#32;&#111;&#108;&#100;&#101;&#114;<br />&#73;&#110;&#32;&#121;&#111;&#117;&#114;&#32;&#101;&#121;&#101;&#115;&#44;&#32;&#73;&#39;&#109;&#32;&#110;&#111;&#116;&#32;&#119;&#111;&#114;&#116;&#104;&#32;&#105;&#116;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br />&#71;&#105;&#109;&#109;&#101;&#32;&#98;&#97;&#99;&#107;&#32;&#109;&#121;&#32;&#97;&#108;&#99;&#111;&#104;&#111;&#108;<br /><br />&#72;&#101;&#97;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;&#44;&#32;&#107;&#105;&#108;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;<br />&#72;&#101;&#97;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;&#44;&#32;&#107;&#105;&#108;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;<br />&#72;&#101;&#97;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;&#44;&#32;&#107;&#105;&#108;&#108;&#32;&#97;&#32;&#109;&#105;&#108;&#108;&#105;&#111;&#110;'''


def extract_text(a):
    w = []
    for i in a.split(';'):
        try:
            if i.replace(' ', '').startswith('<br/>'):
                w.append('\n')
            ch = chr(int(i.split('#')[-1]))
            w.append(ch)
        except:
            continue
    return ''.join(w)


def handle_band(htmlcontent):
    pass


def handle_album(htmlcontent):
    pass


def handle_song(htmlcontent):
    elem = html.fromstring(htmlcontent).xpath('./')


def handle_file(fp):
    with open(fp) as f:
        fcontent = f.read()
        htmlcontent = gzip.decompress(base64.b64decode(fcontent))
        if ":" not in fp:
            handle_band(htmlcontent)
        elif "(" in fp and ")" in fp:
            handle_album(htmlcontent)
        else:
            handle_song(htmlcontent)


if __name__ == '__main__':
    # allfiles = glob.glob('/Users/yiz-mac/datascienceproject/alllyrics/*')
    # for f in allfiles:
    #     handle_file(f)
    # print(len(allfiles))
    print(extract_text(t))

song_dict = {
    "id": "",
    "band": {
        "id": "",
        "name": ""
    },
    "lyrics": "",
    "album": {
        "name": "",
        "year": 0
    }
}
